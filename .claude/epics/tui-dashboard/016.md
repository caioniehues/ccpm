---
id: "016"
name: Implement responsive layout handling
status: pending
created: 2025-12-23T19:45:00Z
updated: 2025-12-23T19:45:00Z
depends_on: ["007"]
parallel: true
conflicts_with: []
effort: M
---

# Task: Implement Responsive Layout Handling

## Description

Implement responsive layout handling for different terminal sizes. The TUI should gracefully adapt to small, medium, large, and extra-tall terminals while maintaining usability.

## Acceptance Criteria

- [ ] Minimum size: 80 columns × 24 rows
- [ ] "Terminal too small" message when below minimum
- [ ] Small (80-99 cols): Single column, abbreviated labels
- [ ] Medium (100-119 cols): Full labels, standard progress bars
- [ ] Large (120+ cols): Side-by-side panels
- [ ] Extra tall (40+ rows): Expanded viewports, more items visible
- [ ] Window resize updates layout immediately
- [ ] No content clipping or overflow

## Size Breakpoints

```
SMALL (80-99 cols)
├── Single column layout
├── Abbreviated labels (e.g., "Prog" instead of "Progress")
├── Compact progress bars (30 chars)
├── Activity log hidden
└── Max 6 task items visible

MEDIUM (100-119 cols)
├── Full labels
├── Standard progress bars (50 chars)
├── Activity log visible
└── Max 8 task items visible

LARGE (120+ cols)
├── Side-by-side panels (tasks | activity)
├── Full activity history
├── Extra metadata visible
└── Max 12 task items visible

EXTRA TALL (40+ rows)
├── Expanded viewports
├── More task items visible
├── Full activity history
└── Additional metadata rows
```

## Files to Create/Update

### internal/tui/layout.go

```go
package tui

// LayoutSize represents terminal size category
type LayoutSize int

const (
    LayoutSmall LayoutSize = iota
    LayoutMedium
    LayoutLarge
)

// LayoutDimensions holds calculated dimensions
type LayoutDimensions struct {
    Size            LayoutSize
    Width           int
    Height          int
    
    HeaderHeight    int
    FooterHeight    int
    ContentHeight   int
    
    EpicCardWidth   int
    EpicCardHeight  int
    
    TaskListWidth   int
    TaskListHeight  int
    TaskItemCount   int
    
    ActivityWidth   int
    ActivityHeight  int
    ActivityVisible bool
    
    SideBySide      bool
    ProgressBarLen  int
}

func CalculateLayout(width, height int) LayoutDimensions {
    d := LayoutDimensions{
        Width:  width,
        Height: height,
    }
    
    // Determine size category
    if width < 100 {
        d.Size = LayoutSmall
    } else if width < 120 {
        d.Size = LayoutMedium
    } else {
        d.Size = LayoutLarge
    }
    
    // Fixed dimensions
    d.HeaderHeight = 8
    d.FooterHeight = 2
    d.ContentHeight = height - d.HeaderHeight - d.FooterHeight
    
    // Calculate based on size
    switch d.Size {
    case LayoutSmall:
        d.EpicCardWidth = width - 4
        d.EpicCardHeight = 10
        d.TaskListWidth = width - 4
        d.TaskListHeight = d.ContentHeight - d.EpicCardHeight - 2
        d.TaskItemCount = min(6, d.TaskListHeight - 2)
        d.ActivityVisible = false
        d.ProgressBarLen = 30
        d.SideBySide = false
        
    case LayoutMedium:
        d.EpicCardWidth = width - 4
        d.EpicCardHeight = 12
        d.TaskListWidth = width - 4
        d.TaskListHeight = d.ContentHeight - d.EpicCardHeight - 8
        d.TaskItemCount = min(8, d.TaskListHeight - 2)
        d.ActivityWidth = width - 4
        d.ActivityHeight = 6
        d.ActivityVisible = true
        d.ProgressBarLen = 50
        d.SideBySide = false
        
    case LayoutLarge:
        d.EpicCardWidth = width - 4
        d.EpicCardHeight = 12
        d.TaskListWidth = (width - 8) / 2
        d.ActivityWidth = (width - 8) / 2
        d.TaskListHeight = d.ContentHeight - d.EpicCardHeight - 2
        d.ActivityHeight = d.TaskListHeight
        d.TaskItemCount = min(12, d.TaskListHeight - 2)
        d.ActivityVisible = true
        d.ProgressBarLen = 60
        d.SideBySide = true
    }
    
    // Extra tall adjustment
    if height >= 40 {
        d.TaskItemCount += 4
        d.ActivityHeight += 4
    }
    
    return d
}

func min(a, b int) int {
    if a < b {
        return a
    }
    return b
}
```

### internal/tui/views/too_small.go

```go
package views

func (m Model) viewTooSmall() string {
    message := fmt.Sprintf(`
╭─────────────────────────────────╮
│                                 │
│   Terminal too small            │
│                                 │
│   Minimum: 80×24                │
│   Current: %d×%d                │
│                                 │
│   Please resize your terminal   │
│                                 │
╰─────────────────────────────────╯
`, m.Width, m.Height)
    
    return lipgloss.Place(
        m.Width, m.Height,
        lipgloss.Center, lipgloss.Center,
        ErrorStyle.Render(message),
    )
}
```

### Update internal/tui/view.go

```go
func (m Model) View() string {
    // Check minimum size
    if m.Width < 80 || m.Height < 24 {
        return m.viewTooSmall()
    }
    
    // Calculate layout
    m.Layout = CalculateLayout(m.Width, m.Height)
    
    // Render current view with layout
    switch m.View {
    case ViewDashboard:
        return m.viewDashboard()
    // ...
    }
}
```

### Update dashboard for side-by-side

```go
func (m Model) viewDashboard() string {
    // ... header and epic card ...
    
    if m.Layout.SideBySide {
        // Large layout: side by side
        taskPanel := m.renderTaskList(m.Layout.TaskListHeight)
        activityPanel := m.renderActivityLog(m.Layout.ActivityHeight)
        
        content := lipgloss.JoinHorizontal(
            lipgloss.Top,
            taskPanel,
            "  ",
            activityPanel,
        )
        // ...
    } else {
        // Small/medium: stacked
        taskPanel := m.renderTaskList(m.Layout.TaskListHeight)
        
        if m.Layout.ActivityVisible {
            activityPanel := m.renderActivityLog(m.Layout.ActivityHeight)
            content := lipgloss.JoinVertical(lipgloss.Left, taskPanel, activityPanel)
        }
        // ...
    }
}
```

## Design Reference

- Responsive Behavior: TUI-WIREFRAMES.md lines 1214-1261

## Definition of Done

- Layout adapts correctly at each breakpoint
- "Too small" message displays when under 80x24
- Side-by-side layout works at 120+ columns
- Window resize triggers immediate re-layout
- No content overflow or clipping
- Usable at minimum 80x24 size
