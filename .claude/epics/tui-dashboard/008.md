---
id: "008"
name: Implement epic & task detail views
status: completed
created: 2025-12-23T19:45:00Z
updated: 2025-12-23T20:15:00Z
depends_on: ["006"]
parallel: true
conflicts_with: []
effort: M
---

# Task: Implement Epic & Task Detail Views

## Description

Implement the Epic Detail view (Wireframe #2) and Task Detail view (Wireframe #3) that show full content with scrollable viewports.

## Acceptance Criteria

### Epic Detail View
- [ ] Breadcrumb navigation (← Dashboard › Epic Details)
- [ ] Epic name and metadata (status, created, branch, source PRD)
- [ ] Scrollable viewport for epic markdown content
- [ ] Phase status indicators (PRD → Epic → Tasks flow)
- [ ] Footer with [←]back [t]asks [p]rd [s]ync [m]ark complete

### Task Detail View
- [ ] Breadcrumb navigation (← Dashboard › Epic › Task Details)
- [ ] Task name, status progress bar, timestamps
- [ ] Dependencies and blocked-by info
- [ ] Scrollable task description with acceptance criteria
- [ ] Requirements trace section (linked PRD/Epic sections)
- [ ] Footer with [←]back [c]omplete [b]lock [n]ext task [g]ithub

## Files to Create

### internal/tui/views/epic_detail.go

```go
package views

import (
    "github.com/charmbracelet/bubbles/viewport"
    "github.com/charmbracelet/glamour"
    "github.com/charmbracelet/lipgloss"
)

func (m Model) viewEpicDetail() string {
    if m.ActiveEpic == nil {
        return m.viewDashboard()
    }
    
    // Breadcrumb
    breadcrumb := MutedStyle.Render("← Dashboard › Epic Details")
    
    // Epic header
    title := AccentStyle.Render("◆ " + m.ActiveEpic.Name)
    divider := strings.Repeat("═", m.Width - 8)
    
    // Metadata
    meta := lipgloss.JoinVertical(
        lipgloss.Left,
        LabelStyle.Render("STATUS") + "        " + m.ActiveEpic.Status,
        LabelStyle.Render("CREATED") + "       " + m.ActiveEpic.CreatedAt,
        LabelStyle.Render("BRANCH") + "        " + m.ActiveEpic.Branch,
        LabelStyle.Render("SOURCE PRD") + "    ◈ " + m.ActiveEpic.PRDName,
    )
    
    // Epic document viewport
    docTitle := LabelStyle.Render("EPIC DOCUMENT")
    
    // Render markdown with glamour
    renderer, _ := glamour.NewTermRenderer(
        glamour.WithAutoStyle(),
        glamour.WithWordWrap(m.Width - 12),
    )
    rendered, _ := renderer.Render(m.ActiveEpic.Content)
    
    m.Viewport.SetContent(rendered)
    doc := SubtleCard.Render(
        lipgloss.JoinVertical(lipgloss.Left, docTitle, m.Viewport.View()),
    )
    
    // Phase status
    phases := m.renderPhaseStatus()
    
    // Footer
    footer := m.renderEpicDetailFooter()
    
    // Compose
    content := lipgloss.JoinVertical(
        lipgloss.Left,
        breadcrumb,
        "",
        title,
        divider,
        "",
        meta,
        "",
        doc,
        "",
        phases,
    )
    
    return AppFrame.Render(content) + "\n" + footer
}

func (m Model) renderPhaseStatus() string {
    // [■] PRD Created ──▶ [■] Epic Approved ──▶ [◐] Tasks
    phases := `
┌──────────────────────────────────────────────────────────┐
│                                                          │
│  [■] PRD Created   ──▶  [■] Epic Approved  ──▶  [◐] Tasks│
│                                                          │
│       ✓ Approved            ✓ Approved          3/6 done │
│                                                          │
└──────────────────────────────────────────────────────────┘`
    return MutedStyle.Render(phases)
}
```

### internal/tui/views/task_detail.go

```go
package views

func (m Model) viewTaskDetail() string {
    if len(m.Tasks) == 0 || m.ActiveTask >= len(m.Tasks) {
        return m.viewDashboard()
    }
    
    task := m.Tasks[m.ActiveTask]
    
    // Breadcrumb
    breadcrumb := MutedStyle.Render("← Dashboard › Epic › Task Details")
    
    // Task header with status icon
    icon := "▶"
    if task.Status == "completed" { icon = "▣" }
    if task.Status == "blocked" { icon = "⊘" }
    
    title := AccentStyle.Render(icon + " " + task.ID + ": " + task.Name)
    
    // Status with progress bar
    prog := progress.New(progress.WithGradient(Electric, Volt))
    statusLine := lipgloss.JoinHorizontal(
        lipgloss.Top,
        LabelStyle.Render("STATUS") + "        ",
        prog.ViewAs(task.Progress),
        fmt.Sprintf(" %d%% %s", int(task.Progress*100), task.Status),
    )
    
    // Metadata
    meta := lipgloss.JoinVertical(
        lipgloss.Left,
        statusLine,
        LabelStyle.Render("STARTED") + "       " + task.StartedAt,
        LabelStyle.Render("DEPENDS ON") + "    " + task.DependsOn,
        LabelStyle.Render("BLOCKED BY") + "    " + task.BlockedBy,
    )
    
    // Task description viewport
    docTitle := LabelStyle.Render("TASK DESCRIPTION")
    m.Viewport.SetContent(task.Description)
    doc := SubtleCard.Render(
        lipgloss.JoinVertical(lipgloss.Left, docTitle, m.Viewport.View()),
    )
    
    // Requirements trace
    trace := m.renderRequirementsTrace(task)
    
    // Footer
    footer := m.renderTaskDetailFooter()
    
    content := lipgloss.JoinVertical(
        lipgloss.Left,
        breadcrumb,
        "",
        title,
        strings.Repeat("═", m.Width - 8),
        "",
        meta,
        "",
        doc,
        "",
        trace,
    )
    
    return AppFrame.Render(content) + "\n" + footer
}

func (m Model) renderRequirementsTrace(task Task) string {
    return SubtleCard.Render(`
REQUIREMENTS TRACE

Linked to:
  ◈ PRD → Section 3.2: Session Management
  ◆ Epic → Goal 4: Session persistence with Redis

Leverages:
  • src/lib/redis-client.ts (existing)
  • src/types/session.d.ts (existing)
`)
}
```

## Design Reference

- Epic Detail: TUI-WIREFRAMES.md lines 354-409 (Wireframe #2)
- Task Detail: TUI-WIREFRAMES.md lines 411-465 (Wireframe #3)

## Definition of Done

- Both views render with all sections
- Viewport scrolling works for long content
- Markdown renders with glamour styling
- Navigation between views works
- Footer keybindings are functional
